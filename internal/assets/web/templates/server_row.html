<td class="px-4 py-2">
    <div>
        <span class="font-medium text-gray-800">{{.server.Name}}</span>
        {{if .server.Env}}
        <div class="text-xs text-gray-500 mt-1">
            {{range $key, $value := .server.Env}}
            <span class="bg-gray-200 rounded px-1">{{$key}}</span>
            {{end}}
        </div>
        {{end}}
    </div>
</td>
<td class="px-4 py-2">
    <div class="text-sm text-gray-600">
        {{if .server.Command}}
            <div class="flex items-center space-x-1">
                <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium">STDIO</span>
                <code>{{.server.Command}} {{range .server.Args}}{{.}} {{end}}</code>
            </div>
        {{else if .server.URL}}
            <div class="flex items-center space-x-1">
                <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium">SSE</span>
                <code>{{.server.URL}}</code>
            </div>
        {{else if .server.HttpURL}}
            <div class="flex items-center space-x-1">
                <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs font-medium">HTTP</span>
                <code>{{.server.HttpURL}}</code>
            </div>
        {{else}}
            <span class="text-gray-400 italic">No transport configured</span>
        {{end}}
        {{if .server.Headers}}
        <div class="text-xs text-gray-500 mt-1">
            Headers: {{range $key, $value := .server.Headers}}<span class="bg-gray-200 rounded px-1">{{$key}}</span> {{end}}
        </div>
        {{end}}
    </div>
</td>
<td class="px-4 py-2 text-center">
    <label class="inline-flex items-center">
        <input type="checkbox"
               class="form-checkbox h-5 w-5 text-blue-600"
               {{if .server.EnabledGlobally}}checked{{end}}
               hx-post="/htmx/servers/{{.server.Name}}/toggle"
               hx-vals='{"enabled": "{{if .server.EnabledGlobally}}false{{else}}true{{end}}"}'
               hx-target="#server-{{.server.Name}}"
               hx-swap="outerHTML"
               hx-trigger="click"
               _="on htmx:afterRequest trigger configChanged on body">
    </label>
</td>
{{range .clients}}
<td class="px-4 py-2 text-center" id="client-{{.Name}}-server-{{$.server.Name}}">
    {{template "client_toggle.html" dict "server" $.server "client" .Name}}
</td>
{{end}}